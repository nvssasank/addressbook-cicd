---
- hosts: appnode
  become: yes
  tasks:
    - name: install Java
      apt:
        name: openjdj-11-jdk
        state: present
      when: ansible_os_family == "Debian"

    - name: Download Tomcat 9
      get_url:
        url: https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.82/bin/apache-tomcat-9.0.82.tar.gz
        dest: /tmp/tomcat.tar.gz
    - name: Extract Tomcat
      unarchive: 
        src: /tmp/tomcat.tar.gz
        dest: /opt/
        remote_src: yes
        creates: /opt/apache-tomcat-9.0.82

    - name: Symlink Tomcat
      file:
        src: /opt/apache-tomcat-9.0.82
        dest: /opt/tomcat
        sate: link
    - name: Set permissions
      file:
        path: /opt/apache-tomcat-9.0.82
        owner: ubuntu
        group: ubuntu
        mode: '0755'
        resourse: yes       


